# IrfanView 4.52 - 32 bit crash at eip 004249c6

Last version at the moment of publication is 4.52

![](https://i.imgur.com/g1WwQJj.png)

![](https://i.imgur.com/yVB75je.png)

## Steps to reproduce

1. Use IrfanView v4.52
2. Enable pageheap (without verifier reproducing process can be unstable)
```
C:\Program Files (x86)\Windows Kits\10\Debuggers\x86>gflags /p /enable i_view32.exe /full
Warning: pageheap.exe is running inside WOW64.
This scenario can be used to test x86 binaries (running inside WOW64)
but not native (IA64) binaries.

path: SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options
    i_view32.exe: page heap enabled
```
3. Run windbg
4. Open irfanview in windbg
5. Open testcase in IrfanView


## The bug

TIF file parsing heap OOB

```
(1470.12b8): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax=000000ff ebx=00000001 ecx=00000fff edx=00000000 esi=0da53000 edi=00000fff
eip=004249c6 esp=00197494 ebp=00000001 iopl=0         nv up ei pl nz ac pe nc
cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00010216
image00400000+0x249c6:
004249c6 8806            mov     byte ptr [esi],al          ds:002b:0da53000=??
0:000> kb
 # ChildEBP RetAddr  Args to Child              
WARNING: Stack unwind information not available. Following frames may be wrong.
00 001974dc 004a4628 0df64b18 437f8000 0059dab0 image00400000+0x249c6
01 00000000 00000000 00000000 00000000 00000000 image00400000+0xa4628
```
